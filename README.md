# symlink-monorepo

Single command to setup a monorepo using symlinks.

## the problem

Many monorepo projects are set up like this:

```
root
├┬ shared
│└─ util.js
└┬ apps
 ├┬ app1
 │└─ server.js
 └┬ app2
  └─ website.js
```

If you want to import `shared/util.js` from inside `apps/app1/server.js` you could use
relative paths:

```js
// apps/app1/server.js
import util from '../../shared/util.js'
```

But that definitely gets unwieldy pretty fast.

## partial solution

With the power of the NodeJS module resolution algorithm, you can embed a `node_modules` folder
within your project to use absolute paths:

```
root
└┬ apps
 └┬ node_modules
  ├┬ shared
  │└ util.js
  ├┬ app1
  │└─ server.js
  └┬ app2
   └─ website.js
```

Then, to import `apps/node_modules/shared/util.js` from inside `apps/node_modules/app1/server.js` you
can use non-relative paths:

```js
// apps/node_modules/app1/server.js
import util from 'shared/util.js'
```

The good news: this is fully supported with native NodeJS, so no bundler required.

The bad news: it feels a little clumsy, and some bundlers and tooling get really hung
up on the sub-folder named `node_modules`–they often filter by *anything* that has
`node_modules` in the path.

## better solution

Using symlinks, you can use symlinks to point to the appropriate folders, which looks
like this:

```
root
├┬ shared
│└─ util.js
└┬ apps
 ├┬ app1
 │├┬ node_modules
 ││└┬ prefix
 ││ └ shared ⇒ /shared
 │└─ server.js
 └┬ app2
  ├┬ node_modules
  │└┬ prefix
  │ └ shared ⇒ /shared
  └─ website.js
```

So now we have the flat file paths again, without the embedded `node_modules`, and to import
`shared/util.js` from inside `apps/app1/server.js` we can also use non-relative paths:

```js
// apps/app1/server.js
import util from 'prefix/shared/util.js'
```

## this tool

This is a CLI tool that assumes the following folder structure (more about prefixes later):

```
root
├┬ _shared1
│└─ # files and/or folders
├┬ _shared2
│└─ # files and/or folders
└┬ apps_folder
 └┬ app1
  ├┬ _lib1
  │└ # files and/or folders
  ├┬ _lib2
  │└ # files and/or folders
  ├┬ node_modules # generated by this CLI tool
  │└┬ @ # the prefix
  │ ├ shared1 ⇒ /_shared1
  │ ├ shared2 ⇒ /_shared2
  │ ├ lib1 ⇒ /apps_folder/app1/_lib1
  │ └ lib2 ⇒ /apps_folder/app1/_lib2
  └─ # files and/or folders
```

The `apps_folder/*/node_modules` folders in this case would be generated using:

```shell
symlink-monorepo --folderPrefix="_" --npmPrefix="@"
```

Lets break down what this is all about:

### root prefixed folders

TODO

### app prefixed folders

TODO

### npm prefix

TODO
